---
test_name: PUT /analysisd/reload

marks:
  - analysisd

stages:

  - name: Reload analysisd on worker1 and worker2
    request:
      verify: False
      url: "{protocol:s}://{host:s}:{port:d}/analysisd/reload"
      method: PUT
      headers:
        Authorization: "Bearer {test_login_token}"
      params:
        nodes_list: 'worker1,worker2'
    response:
      status_code: 200
      json:
        error: 0
        data:
          affected_items:
            - 'worker1'
            - 'worker2'
          failed_items: []
          total_affected_items: 2
          total_failed_items: 0

  - name: Reload analysisd on all nodes
    request:
      verify: False
      url: "{protocol:s}://{host:s}:{port:d}/analysisd/reload"
      method: PUT
      headers:
        Authorization: "Bearer {test_login_token}"
    response:
      status_code: 200
      json:
        error: 0
        data:
          affected_items:
            - 'master-node'
            - 'worker1'
            - 'worker2'
          failed_items: []
          total_affected_items: 3
          total_failed_items: 0